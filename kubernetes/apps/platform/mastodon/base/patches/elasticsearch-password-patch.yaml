apiVersion: apps/v1
kind: Deployment
metadata:
  name: mastodon-web
  namespace: mastodon
spec:
  template:
    spec:
      containers:
      - name: web
        env:
        - name: ES_PASS
          valueFrom:
            secretKeyRef:
              name: elasticsearch-es-elastic-user
              key: elastic
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mastodon-sidekiq-default
  namespace: mastodon
spec:
  template:
    spec:
      containers:
      - name: sidekiq-default
        env:
        - name: ES_PASS
          valueFrom:
            secretKeyRef:
              name: elasticsearch-es-elastic-user
              key: elastic
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mastodon-sidekiq-federation
  namespace: mastodon
spec:
  template:
    spec:
      containers:
      - name: sidekiq-federation
        env:
        - name: ES_PASS
          valueFrom:
            secretKeyRef:
              name: elasticsearch-es-elastic-user
              key: elastic
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mastodon-sidekiq-background
  namespace: mastodon
spec:
  template:
    spec:
      containers:
      - name: sidekiq-background
        env:
        - name: ES_PASS
          valueFrom:
            secretKeyRef:
              name: elasticsearch-es-elastic-user
              key: elastic
---
apiVersion: apps/v1
kind: Deployment
metadata:
  name: mastodon-sidekiq-scheduler
  namespace: mastodon
spec:
  template:
    spec:
      containers:
      - name: sidekiq-scheduler
        env:
        - name: ES_PASS
          valueFrom:
            secretKeyRef:
              name: elasticsearch-es-elastic-user
              key: elastic
